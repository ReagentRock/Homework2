---
title: "Professors"
author: "Elijah Wang"
date: "2025-01-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
profs<-read.csv("profs.csv")
bike<-read.csv("bikeshare.csv")
capmetro_UT<-read.csv("capmetro_UT.csv")
board<-read.csv("billboard.csv")
library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
ggprofs<-ggplot(profs)

ggprofs+geom_histogram(aes(x=eval))

ggprofs+geom_boxplot(aes(x=profs$eval,y=profs$native))

ggprofs+geom_histogram(aes(x=profs$eval))+facet_wrap(~gender)

ggprofs+geom_point(aes(x=profs$beauty,y=profs$eval))
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
ggbike<-ggplot(bike)
ggbike+geom_line(aes(x=hr,y=total))

ggbike+geom_line(aes(x=hr,y=total))+facet_wrap(~workingday)

nine = bike%>%filter(hr==9)
ggnine<-ggplot(nine)

ggnine+geom_col(aes(x=weathersit,y=total))+facet_wrap(~workingday)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```{r}


# Recode the categorical variables in sensible, rather than alphabetical, order
capmetro_UT = mutate(capmetro_UT,
day_of_week = factor(day_of_week,
levels=c("Mon", "Tue", "Wed","Thu", "Fri", "Sat", "Sun")),
month = factor(month,
levels=c("Sep", "Oct","Nov")))

ggmetro<-ggplot(capmetro_UT)

ggmetro+geom_line(aes(x=hour_of_day,y=boarding,color=month))+facet_wrap(~day_of_week)

ggmetro+geom_point(aes(x=temperature,y=boarding,color=weekend))+facet_wrap(~hour_of_day)
```
```{r}

tab<-data.frame(table(board$song_id))
tab<-tab%>%arrange(desc(Freq))%>%head(10)
tab$performer<-c("Imagine Dragons", "AWOLNATION","TheWeeknd","JasonMraz","AnnRimes","OneRepublic", "LMFAO Featuring Lauren Bennett & GoonRock","Jewel","Adele","Carrie Underwood")
tab$Var1<-c("Radioactive","Sail","Blinding Lights", "I'm Yours", "How Do I Live", "Counting Stars", "Party Rock Anthem", "Foolish Games/You Were Meant for Me","Rolling in the Deep","Before He Cheats")

board%>%filter(year!=2021|year!=1958)

#find num of unique songs every year

hold<-c()
for(i in min(board$year):max(board$year)){
  hold[i-1957]<-nrow(unique(filter(board,year==i)[5]))  
}

board<-mutate(board,unique=hold[board$year-1957])

ggboard<-ggplot(board)
ggboard+geom_line(aes(x=year,y=hold))


#find songs that had top 100 for at least 10 weeks per year.
topsong<-data.frame(table(board$song))
topsong<-topsong%>%arrange(desc(topsong[2]))




people<-data.frame(table(board$performer))
people<-people%>%filter(people[2]>=30)
people<-people%>%arrange(desc(people[2]))
people

unique(board$song_id)

fame<-c()
board$performer<-str_remove_all(board$performer,"\\?\\+")

for(i in 1:length(unique(board$performer))){
  fame[i]<-sum(str_detect(unique(board$song_id),unique(board$performer)[i]))  
}

topsinger<-data.frame(unique(board$performer))
topsinger<-data.frame(fame)
  ggplot(topsinger)+geom_bar(aes(x=topsinger[1],y=topsinger[2]))
  #add amount of top songs
```

